cmake_minimum_required(VERSION 2.8)

project(libkvsCommonLws-download NONE)

include(ExternalProject)

ExternalProject_Add(libkvsCommonLws-download
    SOURCE_DIR        ${CMAKE_CURRENT_SOURCE_DIR}/../../CMake/Dependencies/amazon-kinesis-video-streams-producer-c
    DOWNLOAD_COMMAND  
              cp -av ${CMAKE_CURRENT_SOURCE_DIR}/../../CMake/Dependencies/amazon-kinesis-video-streams-producer-c/. 
                              ${CMAKE_CURRENT_BINARY_DIR}/kvscproducer-src
    SOURCE_DIR        "${CMAKE_CURRENT_BINARY_DIR}/kvscproducer-src"
    #BINARY_DIR        "${CMAKE_CURRENT_BINARY_DIR}/kvscproducer-build"
    BUILD_IN_SOURCE   FALSE
    PREFIX            ${CMAKE_CURRENT_BINARY_DIR}/build
    CMAKE_ARGS        
      -DCMAKE_INSTALL_PREFIX=${OPEN_SRC_INSTALL_PREFIX}
      -DBUILD_COMMON_LWS=ON
      -DBUILD_COMMON_CURL=OFF
      -DBUILD_DEPENDENCIES=FALSE
      -DOPEN_SRC_INSTALL_PREFIX=${OPEN_SRC_INSTALL_PREFIX}
      -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE}
      -DUSE_OPENSSL=${USE_OPENSSL}
      -DUSE_MBEDTLS=${USE_MBEDTLS}
      -DCMAKE_C_FLAGS=${CMAKE_C_FLAGS}
    TEST_COMMAND      ""
)
